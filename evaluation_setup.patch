Index: test/src/main.c
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/test/src/main.c b/test/src/main.c
--- a/test/src/main.c	(revision b17d009babf4d3f40cb0cc60c43adbd12abb058a)
+++ b/test/src/main.c	(date 1652853042427)
@@ -5,6 +5,27 @@
 #include "test_async.h"
 #include "test_user.h"
 
+#define TEST 1
+
+#if TEST
+int main()
+{
+	int i;
+	char *addr;
+
+	i = 0;
+	while (i < 1024)
+	{
+		addr = (char*)malloc(1024);
+		addr[0] = 42;
+		i++;
+	}
+
+	printf("%i", requested_pages_count);
+
+	return (0);
+}
+#else
 int main()
 {
 	test_error();
@@ -13,4 +34,5 @@
 	test_data();
 	test_async();
 	test_user();
-}
\ No newline at end of file
+}
+#endif
\ No newline at end of file
Index: main/src/heap.c
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/main/src/heap.c b/main/src/heap.c
--- a/main/src/heap.c	(revision b17d009babf4d3f40cb0cc60c43adbd12abb058a)
+++ b/main/src/heap.c	(date 1652853042428)
@@ -248,6 +248,8 @@
 
 // HEAP MANIPULATION -------------------------------------------------------------------------------------------------------------------------------------------
 
+int requested_pages_count;
+
 struct heap *heap_allocate(size_t min_block_payload_size, size_t max_block_payload_size, size_t number_of_blocks)
 {
 	// Compute heap size
@@ -262,6 +264,8 @@
 	if (ptr == MAP_FAILED)
 		return NULL;
 
+	requested_pages_count += (int)(heap_size / get_page_size());
+
 	struct heap *heap = (struct heap *)ptr;
 
 	// Initialize instance
Index: main/include/utility_memory.h
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/main/include/utility_memory.h b/main/include/utility_memory.h
--- a/main/include/utility_memory.h	(revision b17d009babf4d3f40cb0cc60c43adbd12abb058a)
+++ b/main/include/utility_memory.h	(date 1652852880983)
@@ -4,6 +4,8 @@
 #include <stdlib.h>
 #include "heap.h"
 
+#define FAKE_PAGE_SIZE 4096
+
 size_t get_allocation_limit();
 size_t get_page_size();
 
Index: main/include/malloc_debug.h
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/main/include/malloc_debug.h b/main/include/malloc_debug.h
--- a/main/include/malloc_debug.h	(revision b17d009babf4d3f40cb0cc60c43adbd12abb058a)
+++ b/main/include/malloc_debug.h	(date 1652821277926)
@@ -13,6 +13,8 @@
 #define ANSI_CYAN    "\x1b[36m"
 #define ANSI_RESET   "\x1b[0m"
 
+extern int requested_pages_count;
+
 void show_alloc_mem();
 void show_alloc_mem_ex(const char *message);
 void show_mem_debug(const char *message, t_bool show_allocated_blocks, t_bool show_free_blocks);
